var z=Object.defineProperty,W=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var E=(i,s,l)=>s in i?z(i,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[s]=l,S=(i,s)=>{for(var l in s||(s={}))G.call(s,l)&&E(i,l,s[l]);if(N)for(var l of N(s))Y.call(s,l)&&E(i,l,s[l]);return i},D=(i,s)=>W(i,K(s));import{o as u,c as f,p as I,a as H,b as e,d as Z,t as q,n as x,r as U,e as C,f as J,g as h,h as y,w as V,v as T,i as A,j as X,F as R,k as Q,l as ee,m as j,T as se,q as $,s as te,u as ie}from"./vendor.53c3f71d.js";const le=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function l(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(a){if(a.ep)return;a.ep=!0;const o=l(a);fetch(a.href,o)}};le();var g=(i,s)=>{const l=i.__vccOpts||i;for(const[t,a]of s)l[t]=a;return l};const oe={name:"OjaHeader"},F=i=>(I("data-v-1be3cb9f"),i=i(),H(),i),ae={class:"headline"},ne=F(()=>e("span",{class:"o"},"o",-1)),re=F(()=>e("span",{class:"ja"},"ja",-1)),de=Z(" tech test by Bruce Royce "),ce=[ne,re,de];function _e(i,s,l,t,a,o){return u(),f("div",ae,ce)}var O=g(oe,[["render",_e],["__scopeId","data-v-1be3cb9f"]]);const ue={name:"CredentialValidityMarker",props:{msg:{type:String,required:!0,default:"Default Message"},state:{type:Boolean,required:!0,default:!1}}},pe=e("div",{class:"_icon"},null,-1),me={class:"_msg"};function ve(i,s,l,t,a,o){return u(),f("div",{class:x(["ojaPassChecks scaleUp",l.state?"_done":"_pending"])},[pe,e("div",me,q(l.msg),1)],2)}var fe=g(ue,[["render",ve]]);const he={name:"Spinner",props:{isActive:{type:Boolean,required:!0,default:!1}}},ye=e("div",{class:"_isBusy"},null,-1),ge=[ye];function we(i,s,l,t,a,o){return u(),f("div",{class:x(["overAll",{_active:l.isActive}])},ge,2)}var P=g(he,[["render",we]]);const ke={name:"Registration",components:{Spinner:P,OjaHeader:O,CredentialValidityMarker:fe},props:["isModuleBusy"],setup(i,s){var l=U({email:{value:"",isRequired:!0},password:{value:"",isRequired:!0},name:{value:"",isRequired:!1},postcode:{value:"",isRequired:!1}}),t=U({hasLowerCase:!1,hasUpperCase:!1,hasDigit:!1,isLong:!1,isValid:!1}),a=U({state:"visibility_off",inputType:{visibility_off:"password",visibility:"text"},icon:{visible:"visibility_off",hidden:"visibility"}}),o=C(null);function c(r){let n=[],p={isValid:"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",hasLowerCase:/([a-z])/g,hasUpperCase:/([A-Z])/g,hasDigit:/([0-9])/g,isLong:/.{8,}/g};return Object.keys(p).forEach(m=>{if(new RegExp(p[m]).test(r)){if(m==="valid")return["valid"];n.push(m)}}),n}function d(r=l.password.value){const n=c(r);Object.keys(t).forEach(p=>{t[p]=n.find(m=>m===p)})}function _(r){let n=document.createElement("input");return n.setAttribute("type","email"),n.setAttribute("required",l.email.isRequired?"true":"false"),n.setAttribute("value",r),n.checkValidity()}function v(r=l.email.value){const n=_(r);return o.value=n,console.log("Email validity = "+n),n}function k(){a.state===a.icon.visible?a.state=a.icon.hidden:a.state=a.icon.visible}function L(){let r=!0;if(!t.isValid){r=!1;const p=C(password).value;n(p,!0)}if(!o.value){r=!1;const p=C(email).value;n(p,!0)}return r;function n(p,m=!1){m&&p.classList.add("_bad"),p.classList.add("wrongAnswer"),setTimeout(()=>{m&&p.classList.remove("_bad"),p.classList.remove("wrongAnswer")},700)}}const B=Q("addUser");function M(){if(L()){let r={};for(const n in l)r[n]=l[n].value;B(r)}}function b(){s.emit("error")}return D(S({},J(l)),{passwordValidityCheck:t,emailValidityCheck:o,passwordVisibility:a,checkPasswordValidity:d,checkEmailValidity:v,togglePasswordVisibility:k,submitForm:M,emitError:b})},emits:["error"]},be={class:"ojaInnerBox _r"},Ae={id:"registration"},Ce={class:"flex _hor _wFull"},Le={class:"ojaInputRow"},Ve=e("label",{for:"email",class:"lbl _required"},"Enter Your email",-1),xe=["required"],Ue={class:"ojaPassCheckWrapper"},Me={key:2,style:{height:"24px"}},je={class:"ojaInputRow",style:{"margin-top":"16px"}},$e=e("label",{for:"password",class:"lbl _required"},"Choose a password",-1),Te={class:"flex _hor _noWrap",ref:"password"},Re=["type","required"],Be={class:"icons _lined"},Ne={class:"ojaPassCheckWrapper"},Ee={class:"ojaInputRow"},Se={class:"flex _hor _wFull _justBetween _gaped5"},De={class:"wHalf"},Ie=e("label",{for:"fullName"},"Your name",-1),He={class:"wHalf"},qe=e("label",{for:"postcode"},"Postcode",-1),Fe={class:"ojaInputRow_btn"},Oe={style:{border:"1px solid silver","text-align":"center",width:"70%"}},Pe=e("p",{style:{"font-size":"8pt"}},"For development tests only",-1);function ze(i,s,l,t,a,o){const c=h("Spinner"),d=h("CredentialValidityMarker");return u(),f(R,null,[e("div",be,[y(c,{isActive:l.isModuleBusy},null,8,["isActive"]),e("form",Ae,[e("div",Ce,[e("div",Le,[Ve,V(e("input",{id:"email",name:"email",ref:"email",class:"ojaInput",type:"email",required:i.email.isRequired,autocomplete:"email",onBlur:s[0]||(s[0]=_=>t.checkEmailValidity()),"onUpdate:modelValue":s[1]||(s[1]=_=>i.email.value=_)},null,40,xe),[[T,i.email.value]]),e("div",Ue,[t.emailValidityCheck===!1?(u(),A(d,{key:0,msg:"Check your email validity",state:!1})):t.emailValidityCheck===!0&&i.email.value!==""?(u(),A(d,{key:1,msg:"Looks Okay!",state:!0})):(u(),f("div",Me))])]),e("div",je,[$e,e("div",Te,[V(e("input",{id:"password",name:"password",class:"ojaInput",autocomplete:"new-password",type:t.passwordVisibility.inputType[t.passwordVisibility.state],onKeyup:s[2]||(s[2]=_=>t.checkPasswordValidity()),required:i.password.isRequired,"onUpdate:modelValue":s[3]||(s[3]=_=>i.password.value=_)},null,40,Re),[[X,i.password.value]]),e("div",{class:"ojaInput _post _isBtn",onClick:s[4]||(s[4]=(..._)=>t.togglePasswordVisibility&&t.togglePasswordVisibility(..._))},[e("div",Be,q(t.passwordVisibility.state),1)])],512),e("div",Ne,[y(d,{msg:"Include a lowercase",state:!!(t.passwordValidityCheck.isValid||t.passwordValidityCheck.hasLowerCase)},null,8,["state"]),y(d,{msg:"Include an Uppercase",state:!!(t.passwordValidityCheck.isValid||t.passwordValidityCheck.hasUpperCase)},null,8,["state"]),y(d,{msg:"Include a digit",state:!!(t.passwordValidityCheck.isValid||t.passwordValidityCheck.hasDigit)},null,8,["state"]),y(d,{msg:"Min. 8 characters",state:!!(t.passwordValidityCheck.isValid||t.passwordValidityCheck.isLong)},null,8,["state"])])]),e("div",Ee,[e("div",Se,[e("div",De,[Ie,V(e("input",{type:"text",name:"fullName",id:"fullName",autocomplete:"name","onUpdate:modelValue":s[5]||(s[5]=_=>i.name.value=_),class:"ojaInput"},null,512),[[T,i.name.value]])]),e("div",He,[qe,V(e("input",{type:"text",name:"postcode",id:"postcode",autocomplete:"postal-code","onUpdate:modelValue":s[6]||(s[6]=_=>i.postcode.value=_),class:"ojaInput"},null,512),[[T,i.postcode.value]])])])])]),e("div",Fe,[e("div",{class:"btn",onClick:s[7]||(s[7]=(..._)=>t.submitForm&&t.submitForm(..._))},"Create an account")])])]),e("div",Oe,[Pe,e("button",{onClick:s[8]||(s[8]=(..._)=>t.emitError&&t.emitError(..._))},"Test Registration Error")])],64)}var We=g(ke,[["render",ze]]);const Ke={name:"NavBar",data(){return{searchTerm:""}},methods:{listAll(){this.$emit("listAll",!0)},registerNew(){this.$emit("registerNew",!0)},deleteAll(){this.$emit("deleteAll",!0)},search(){this.$emit("search",this.searchTerm)}}},Ge={class:"flex _hor _gaped10 _on_start _on_middle _mt30",style:{"align-self":"flex-start"}},Ye={class:"flex _wFull _noWrap _on_center",style:{margin:"-0px"}};function Ze(i,s,l,t,a,o){return u(),f("div",Ge,[e("div",{class:"btn _wAuto",onClick:s[0]||(s[0]=(...c)=>o.listAll&&o.listAll(...c))},"List All Users"),e("div",{class:"btn _wAuto",onClick:s[1]||(s[1]=(...c)=>o.registerNew&&o.registerNew(...c))},"Register a new User"),e("div",{class:"btn _wAuto",onClick:s[2]||(s[2]=(...c)=>o.deleteAll&&o.deleteAll(...c))},"Delete All Users"),e("div",Ye,[V(e("input",{type:"text",name:"search",id:"search",class:"searchBar",placeholder:"Search name, email or postcode","onUpdate:modelValue":s[3]||(s[3]=c=>a.searchTerm=c)},null,512),[[T,a.searchTerm]]),e("div",{class:"searchBar_post",onClick:s[4]||(s[4]=(...c)=>o.search&&o.search(...c))},"search")])])}var Je=g(Ke,[["render",Ze]]);const Xe={name:"ListAll",components:{Spinner:P},props:["isModuleBusy"],inject:["usersReactive"],emits:["error","deleteUser","emailUser"],methods:{emitError(){this.$emit("error")},delUser(i){this.$emit("deleteUser",i)},emailUser(i){this.$emit("emailUser",i)}},computed:{listUsers(){return this.usersReactive.users}}},w=i=>(I("data-v-68f1974b"),i=i(),H(),i),Qe={class:"ojaInnerBox _r ojaAlignSelfTop",style:{"flex-grow":"1"}},es={class:"_gird_lineNumber"},ss=["innerHTML"],ts={class:"_gird_info"},is={class:"_btns"},ls=["onClick"],os=["onClick"],as={class:"_textual"},ns={class:"infoLine"},rs=w(()=>e("span",{class:"icons _lined"},"email",-1)),ds=["innerHTML"],cs={class:"infoLine"},_s=w(()=>e("span",{class:"icons _lined"},"password",-1)),us=["innerHTML"],ps={class:"infoLine"},ms=w(()=>e("span",{class:"icons _lined"},"fingerprint",-1)),vs=["innerHTML"],fs={class:"infoLine"},hs=w(()=>e("span",{class:"icons _lined"},"badge",-1)),ys=["innerHTML"],gs={class:"infoLine"},ws=w(()=>e("span",{class:"icons _lined"},"place",-1)),ks=["innerHTML"],bs=w(()=>e("div",{class:"_grid_more"},null,-1)),As={key:1,class:"flex _wFull _hFull _on_center _on_middle"},Cs=w(()=>e("div",{class:"text _bold"},"Nothing here yet! \u{1F914}",-1)),Ls=[Cs],Vs={style:{border:"1px solid silver","text-align":"center",width:"70%"}},xs=w(()=>e("p",{style:{"font-size":"8pt"}},"For development tests only",-1));function Us(i,s,l,t,a,o){const c=h("Spinner");return u(),f(R,null,[e("div",Qe,[y(c,{"is-active":l.isModuleBusy},null,8,["is-active"]),Object.keys(o.usersReactive.users).length?(u(!0),f(R,{key:0},ee(o.listUsers,(d,_,v)=>(u(),f("div",{key:d.id,class:"ojaListGrid"},[e("div",es,[e("div",{class:"text _encircled",innerHTML:isNaN(v)?1:parseInt(v)+1},null,8,ss)]),e("div",ts,[e("div",is,[e("div",{class:"btn _thin _wAuto",onClick:k=>o.delUser(d.id)},"delete",8,ls),e("div",{class:"btn _thin _wAuto",onClick:k=>o.emailUser(d.id)},"Contact",8,os)]),e("div",as,[e("div",ns,[rs,e("span",{class:x(["text _bold",{marked:d.mark==="email"}]),innerHTML:d.email},null,10,ds)]),e("div",cs,[_s,e("span",{class:"text",innerHTML:d.password},null,8,us)]),e("div",ps,[ms,e("span",{class:"text",innerHTML:d.id},null,8,vs)]),e("div",fs,[hs,e("span",{class:x(["text",{marked:d.mark==="name"}]),innerHTML:d.name},null,10,ys)]),e("div",gs,[ws,e("span",{class:x(["text",{marked:d.mark==="postcode"}]),innerHTML:d.postcode},null,10,ks)])])]),bs]))),128)):(u(),f("div",As,Ls))]),e("div",Vs,[xs,e("button",{onClick:s[0]||(s[0]=(...d)=>o.emitError&&o.emitError(...d))},"Generate Api Error")])],64)}var Ms=g(Xe,[["render",Us],["__scopeId","data-v-68f1974b"]]);const js={name:"FullScreen",props:{title:String,msg:String},methods:{modalConfirmed:function(){this.$refs.fullscreen.classList.add("inActive"),this.$emit("ok",!0)}}},$s={class:"fullscreen",ref:"fullscreen"},Ts={class:"ojaInnerBox _r scaleUpSquare"},Rs={class:"flex _ver _on_middle _on_center"},Bs=["innerHTML"],Ns=["innerHTML"];function Es(i,s,l,t,a,o){return u(),f("div",$s,[e("div",Ts,[e("div",Rs,[e("div",{class:"text _bold",style:{"font-size":"120%"},innerHTML:l.title},null,8,Bs),e("div",{class:"text",style:{"text-align":"center"},innerHTML:l.msg},null,8,Ns),e("div",{class:"btn",style:{"margin-top":"30px"},onClick:s[0]||(s[0]=(...c)=>o.modalConfirmed&&o.modalConfirmed(...c))},"OK!")])])],512)}var Ss=g(js,[["render",Es],["__scopeId","data-v-70ff420c"]]);const Ds={components:{FullScreen:Ss,ListAll:Ms,NavBar:Je,Registration:We,OjaHeader:O},setup(){const i="./api/ojax.php";var s=U({users:{}}),l=U({state:!1,title:"Sorry!",msg:"This is just a test.<br>That is not implemented in this exercise!"}),t=C("registration"),a=C(!1),o=C(!0);j("apiUrl",i),j("usersReactive",s),j("listAll",v);function c(){l.state=!1}function d(){t.value="registration",console.log("Register a new Users")}function _(r){let n={operation:"add_user",data:r};console.log(n),b(n,v)}j("addUser",_);function v(){console.log("List All Users"),t.value="listAll",b({operation:"get_user",data:"all"})}function k(){console.log("Delete All Users"),b({operation:"delete_all",data:"all"},v)}function L(r){console.log("Delete All Users"),b({operation:"delete_user",data:r},v)}function B(r){console.log("searching for: ",r),b({operation:"find_user",data:r})}function M(r){switch(r){case"registration":l.title="Cannot Register!",l.msg="Something just went wrong.<br>Please try again later.";break;case"listAll":l.title="Oops!",l.msg="There is an error communicating with the server.<br>Please try again later.";break;default:l.title="This is an interview test!",l.msg="This is just a test.<br>That is not implemented in this exercise!"}l.state=!0}function b(r,n=null,p=null){a.value=!0,te.post(i,r).then(m=>{console.log("AJAX response ",m),typeof m.data=="object"?(console.log("replacing new data"),s.users=m.data):s.users={}}).catch(m=>{console.log(m),M("listAll")}).finally(m=>{a.value=!1,n!==null&&(p!==null?n(...p):n(m))})}return{error:l,isNavActive:o,activeModule:t,isModuleBusy:a,closeFullscreen:c,listAll:v,registerNew:d,searchUsers:B,deleteAll:k,deleteUser:L,apiError:M}}};function Is(i,s,l,t,a,o){const c=h("full-screen"),d=h("oja-header"),_=h("NavBar"),v=h("Registration"),k=h("list-all");return u(),f(R,null,[t.error.state?(u(),A(se,{key:0,to:"#fullscreen"},[y(c,{onOk:t.closeFullscreen,title:t.error.title,msg:t.error.msg},null,8,["onOk","title","msg"])])):$("",!0),y(d),t.isNavActive?(u(),A(_,{key:1,onListAll:t.listAll,onRegisterNew:t.registerNew,onDeleteAll:t.deleteAll,onSearch:t.searchUsers},null,8,["onListAll","onRegisterNew","onDeleteAll","onSearch"])):$("",!0),t.activeModule==="registration"?(u(),A(v,{key:2,isModuleBusy:t.isModuleBusy,onError:s[0]||(s[0]=L=>t.apiError("registration"))},null,8,["isModuleBusy"])):$("",!0),t.activeModule==="listAll"?(u(),A(k,{key:3,isModuleBusy:t.isModuleBusy,onError:s[1]||(s[1]=L=>t.apiError("listAll")),onEmailUser:t.apiError,onDeleteUser:t.deleteUser},null,8,["isModuleBusy","onEmailUser","onDeleteUser"])):$("",!0)],64)}var Hs=g(Ds,[["render",Is]]);ie(Hs).mount("#app");
